# Windows 系统优化工具集

## 📋 项目简介

本项目包含两个专业的 PowerShell 脚本，用于优化和净化 Windows 系统，移除不必要的预装应用并控制系统更新策略。

> **🎯 设计理念**: 安全、可逆、用户友好 - 让Windows系统回归纯净，提升使用体验

## 📁 文件说明

### 1. `卸载系统自带垃圾应用.ps1`
**终极版 Windows 净化与优化脚本 v2.2**

#### 功能特性
- ✅ **智能卸载预装应用**: 安全移除游戏、社交、媒体等垃圾应用
- ✅ **完美错误处理**: 使用 try-catch 结构处理受保护应用的卸载错误
- ✅ **双重清理机制**: 同时移除已安装包和预置包，防止应用重新安装
- ✅ **保护系统稳定**: 智能识别系统核心组件，避免误删重要应用
- ✅ **交互式菜单**: 提供友好的用户界面，支持单项或一键执行

#### 支持移除的应用类型
- **🎮 游戏类**: 纸牌游戏、糖果传奇、Roblox 等
- **🥽 3D/混合现实**: 3D查看器、画图3D、混合现实门户
- **📱 媒体社交**: Spotify、Netflix、Facebook、Instagram、TikTok 等
- **🔧 其他微软应用**: 反馈中心、Skype、入门应用、便签等
- **🛡️ 受保护应用**: Xbox相关组件、画图、录音机等（尝试卸载但可能失败）

### 2. `彻底禁用Windows更新.ps1`
**Windows Update 安全策略控制脚本**

#### 功能特性
- ✅ **安全策略控制**: 通过修改注册表策略控制更新，不禁用系统服务
- ✅ **可逆操作**: 支持禁用和恢复自动更新策略
- ✅ **系统稳定**: 不影响开始菜单等系统功能
- ✅ **简洁高效**: 专注于更新控制，操作简单明了

## 🚀 使用方法

### 前置要求
- Windows 10/11 操作系统
- 管理员权限
- PowerShell 5.0 或更高版本

### 运行步骤

#### 方法一：右键运行（推荐）
1. 右键点击 `.ps1` 脚本文件
2. 选择 **"使用 PowerShell 运行"**
3. 在弹出的 UAC 对话框中点击 **"是"**

#### 方法二：PowerShell 命令行
```powershell
# 以管理员身份打开 PowerShell
# 导航到脚本目录
cd "脚本所在目录路径"

# 运行卸载垃圾应用脚本
.\卸载系统自带垃圾应用.ps1

# 或运行更新控制脚本
.\彻底禁用Windows更新.ps1
```

#### 方法三：批处理文件运行
创建一个 `.bat` 文件来自动以管理员权限运行：
```batch
@echo off
powershell -Command "Start-Process PowerShell -ArgumentList '-ExecutionPolicy Bypass -File \"%~dp0卸载系统自带垃圾应用.ps1\"' -Verb RunAs"
```

### 执行策略设置
如果遇到执行策略限制，请先运行：
```powershell
# 临时允许脚本执行（推荐）
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 或者绕过执行策略（单次运行）
powershell -ExecutionPolicy Bypass -File "脚本路径"
```

## 📖 使用指南

### 卸载垃圾应用脚本操作选项
1. **选项1**: 仅卸载预装垃圾应用
2. **选项2**: 仅控制 Windows 自动更新
3. **选项3**: 一键执行所有净化操作（推荐）
4. **选项Q**: 退出脚本

### Windows 更新控制选项
1. **选项1**: 安全地禁用自动更新
2. **选项2**: 恢复自动更新策略
3. **选项Q**: 退出脚本

## ⚠️ 重要说明

### 安全性保证
- ✅ 所有操作均可逆，不会永久损坏系统
- ✅ 智能识别系统核心组件，避免误删
- ✅ 使用官方 Windows API，安全可靠
- ✅ 不修改系统服务，保持系统稳定

### 注意事项
- 🔸 **运行前建议创建系统还原点**
- 🔸 某些受保护的应用可能无法完全移除（属正常现象）
- 🔸 禁用更新后，建议定期手动检查重要安全更新
- 🔸 如需恢复某个应用，可通过 Microsoft Store 重新安装
- 🔸 企业版或教育版Windows可能有额外的组策略限制
- 🔸 部分应用可能在重大系统更新后重新出现

### 兼容性说明
| Windows版本 | 兼容性 | 说明 |
|------------|--------|------|
| Windows 11 | ✅ 完全支持 | 推荐使用 |
| Windows 10 (2004+) | ✅ 完全支持 | 推荐使用 |
| Windows 10 (1903-1909) | ⚠️ 部分支持 | 某些应用可能无法移除 |
| Windows 10 (1903以下) | ❌ 不推荐 | 可能出现兼容性问题 |

## 🔧 技术细节

### 核心技术
- **PowerShell 5.0+**: 脚本运行环境
- **AppX 包管理**: 使用 `Get-AppxPackage` 和 `Remove-AppxPackage`
- **注册表策略**: 通过 `HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate` 控制更新
- **错误处理**: try-catch 结构确保运行稳定

### 修改的注册表项
```
HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate
├── NoAutoUpdate (DWORD): 1 = 禁用, 删除 = 启用
└── AUOptions (DWORD): 2 = 仅通知
```

## 📝 版本历史

### v2.2 (当前版本) - 2025年7月9日
- ✨ 完善错误处理机制，消除运行时红色错误信息
- 🔧 优化受保护应用的处理逻辑
- 🎨 增强用户体验和操作反馈
- 🛡️ 提升系统兼容性和稳定性

### v2.1
- ➕ 添加一键净化模式
- 📊 优化应用分类和处理策略
- 🎨 改进菜单界面设计

### v2.0
- 🔄 重构代码架构
- ➕ 添加Windows更新控制功能
- 🛡️ 增强安全性和稳定性

## 🔍 常见问题解答 (FAQ)

### Q: 脚本运行后某些应用还在，是否正常？
A: 是的，某些系统核心应用（如Xbox组件）受到保护，无法完全移除。这是Windows的安全机制。

### Q: 禁用更新后如何手动检查更新？
A: 可以通过"设置 → 更新和安全 → Windows更新"手动检查和安装更新。

### Q: 如何恢复被误删的应用？
A: 大部分应用可通过Microsoft Store重新安装，或运行恢复更新策略后让系统自动重装。

### Q: 脚本是否会影响系统稳定性？
A: 不会。脚本只移除非必要应用和修改更新策略，不触及系统核心组件。

## 🤝 支持与反馈

如果在使用过程中遇到问题或有改进建议，请：
1. 检查是否以管理员权限运行
2. 确认 PowerShell 版本兼容性
3. 查看错误信息并参考本文档
4. 检查Windows版本兼容性

### 故障排除
- **权限不足**: 确保以管理员身份运行PowerShell
- **执行策略限制**: 运行 `Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`
- **应用无法卸载**: 某些系统保护应用属正常现象
- **更新策略无效**: 检查是否为企业版Windows，可能有域策略限制

## 📄 许可证与免责声明

本项目仅供学习和个人使用，请遵守相关法律法规。使用本脚本所产生的任何后果由用户自行承担。

**免责声明**:
- 本工具不会故意损坏系统，但建议使用前备份重要数据
- 作者不对使用本工具造成的任何损失承担责任
- 请在充分了解脚本功能后谨慎使用

---

## 🚀 快速开始指南

### 新手推荐流程
1. **创建系统还原点** (控制面板 → 系统 → 系统保护)
2. **右键点击** `卸载系统自带垃圾应用.ps1`
3. **选择** "使用 PowerShell 运行"
4. **选择选项3** 一键净化模式
5. **等待完成** 并重启系统

### 高级用户
- 可分别运行两个脚本进行精细控制
- 支持命令行参数和自动化部署
- 可集成到系统部署脚本中

**⚡ 一键开始**: `卸载系统自带垃圾应用.ps1` → 右键运行 → 选项3 → 完成！
